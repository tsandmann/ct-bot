<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>c't-Bot: log.c-Dateireferenz</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">c't-Bot
   &#160;<span id="projectnumber">1818</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Erzeugt von Doxygen 1.7.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Hauptseite</span></a></li>
      <li><a href="pages.html"><span>Zusätzliche&#160;Informationen</span></a></li>
      <li><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li class="current"><a href="files.html"><span>Dateien</span></a></li>
      <li><a href="dirs.html"><span>Verzeichnisse</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Auflistung&#160;der&#160;Dateien</span></a></li>
      <li><a href="globals.html"><span>Datei-Elemente</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Makrodefinitionen</a> &#124;
<a href="#func-members">Funktionen</a>  </div>
  <div class="headertitle">
<div class="title">log.c-Dateireferenz</div>  </div>
</div>
<div class="contents">

<p>Routinen zum Loggen von Informationen.  
<a href="#details">Mehr ...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ct-Bot_8h_source.html">ct-Bot.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="display_8h_source.html">display.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="command_8h_source.html">command.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="uart_8h_source.html">uart.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mmc-vm_8h_source.html">mmc-vm.h</a>&quot;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include-Abhängigkeitsdiagramm für log.c:</div>
<div class="dyncontent">
<div class="center"><img src="log_8c__incl.png" border="0" usemap="#log_8c" alt=""/></div>
<map name="log_8c" id="log_8c">
</map>
</div>
</div>
<p><a href="log_8c_source.html">gehe zum Quellcode dieser Datei</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Makrodefinitionen</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#a381c342b2b34df0b1a5b39c0d94da4e1">LOG_BUFFER_SIZE</a>&#160;&#160;&#160;200</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#aefb7db7456a848e7cefe90816a5aaa88">LOCK</a>()&#160;&#160;&#160;pthread_mutex_lock(&amp;log_buffer_mutex);</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#a19b1665d85404627bdc076a60e21d926">UNLOCK</a>()&#160;&#160;&#160;pthread_mutex_unlock(&amp;log_buffer_mutex);</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Funktionen</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#a5c4e337465e1bc9246137477d5b8e30c">log_begin</a> (const char *filename, unsigned int line, LOG_TYPE log_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#a4fff2f266fd439fbb104ddb5d7f61533">log_printf</a> (const char *format,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8c.html#ab2c6faf6d03a5e0e458b683f1dc311fb">log_end</a> (void)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Ausführliche Beschreibung</h2>
<div class="textblock"><p>Routinen zum Loggen von Informationen. </p>
<p>Es sollten ausschliesslich nur die Log-Makros: <a class="el" href="command_8c.html#a754b3d074e0af4ad3c7b918dd77ecb2d">LOG_DEBUG()</a>, <a class="el" href="log_8h.html#a8db73317441b94d67ad5e52f543eae38">LOG_INFO()</a>, <a class="el" href="log_8h.html#a077f8d8d27742c1e560c22d1d8ecdd93">LOG_WARN()</a>, <a class="el" href="log_8h.html#af3fb0ee7384d6813437103a2c2646fb7">LOG_ERROR()</a> und <a class="el" href="log_8h.html#a69a0f04694b8deb9a2f8b0a816a76527">LOG_FATAL()</a> verwendet werden. Eine Ausgabe kann wie folgt erzeugt werden: LOG_DEBUG("Hallo Welt!"); LOG_INFO("Wert x=%d", x); Bei den Ausgaben kann auf ein Line Feed am Ende des Strings verzichtet werden, da dies automatisch angehaengt hinzugefuegt wird. Die frueher noetigen Doppelklammern sind nicht mehr noetig, einfach normale Klammern verwenden, siehe Bsp. oben. (Die Doppelklammern funktionieren nicht mit Var-Arg-Makros, die wir aber brauchen, da nun fuer MCU alle Strings im Flash belassen werden sollen, das spart viel RAM :-) )</p>
<pre>
 Die Logausgaben werden generell mit der Definition von LOG_AVAILABLE eingeschaltet
 und sind ansonsten nicht aktiv.</pre><pre> Loggings auf dem PC:
 --------------------
 Hier stehen drei Arten der Ausgabeschnittstellen zur Verfuegung.
 1. Logging ueber ct-Sim:		LOG_CTSIM_AVAILABLE muss definiert sein.
 2. Logging ueber Display:	LOG_DISPLAY_AVAILABLE muss definiert sein, sowie DISPLAY_AVAILABLE.
 3. Logging ueber Konsole:  	Es muss LOG_STDOUT_AVAILABLE definiert sein.</pre><pre> LOG_UART_AVAILABLE steht auf dem PC nicht zur Verfuegung.</pre><pre> Loggings auf dem MCU:
 ---------------------
 Hier stehen drei Arten der Ausgabeschnittstellen zur Verfuegung.
 1. Logging ueber UART:		LOG_UART_AVAILABLE muss definiert sein.
 								Es darf BOT_2_SIM_AVAILABLE nicht definiert sein, da ansonsten
 								diese Kommunikation ueber den UART laeuft.
 2. Logging ueber ct-Sim:		LOG_CTSIM_AVAILABLE muss definiert sein.
 								BOT_2_SIM_AVAILABLE muss zusaetzlich definiert sein.
 3. Logging ueber Display:	LOG_DISPLAY_AVAILABLE muss definiert sein, sowie DISPLAY_AVAILABLE.
 4. Logging in txt auf MMC:	MMC_AVAILABLE und MMC_VM_AVAILABLE muessen an sein.
 </pre><p>Alternativ schlankere Variante fuer MCU und CTSIM, indem man USE_MINILOG aktiviert. Das spart viel Platz in Flash und RAM.</p>
<dl class="author"><dt><b>Autor:</b></dt><dd>Andreas Merkle (<a href="mailto:mail@blue-andi.de">mail@blue-andi.de</a>) </dd></dl>
<dl class="date"><dt><b>Datum:</b></dt><dd>27.02.2006 </dd></dl>

<p>Definiert in Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>
</div><hr/><h2>Makro-Dokumentation</h2>
<a class="anchor" id="aefb7db7456a848e7cefe90816a5aaa88"></a><!-- doxytag: member="log.c::LOCK" ref="aefb7db7456a848e7cefe90816a5aaa88" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOCK</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;pthread_mutex_lock(&amp;log_buffer_mutex);</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Schuetzt den Ausgabepuffer </p>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00099">99</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Wird benutzt von <a class="el" href="log_8c_source.html#l00152">log_begin()</a>.</p>

</div>
</div>
<a class="anchor" id="a381c342b2b34df0b1a5b39c0d94da4e1"></a><!-- doxytag: member="log.c::LOG_BUFFER_SIZE" ref="a381c342b2b34df0b1a5b39c0d94da4e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG_BUFFER_SIZE&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Groesse des Puffers fuer die Logausgaben ueber UART und ueber TCP/IP. </p>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00093">93</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Wird benutzt von <a class="el" href="log_8c_source.html#l00152">log_begin()</a> und <a class="el" href="log_8c_source.html#l00275">log_printf()</a>.</p>

</div>
</div>
<a class="anchor" id="a19b1665d85404627bdc076a60e21d926"></a><!-- doxytag: member="log.c::UNLOCK" ref="a19b1665d85404627bdc076a60e21d926" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNLOCK</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;pthread_mutex_unlock(&amp;log_buffer_mutex);</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Hebt den Schutz fuer den Ausgabepuffer wieder auf </p>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00101">101</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Wird benutzt von <a class="el" href="log_8c_source.html#l00308">log_end()</a>.</p>

</div>
</div>
<hr/><h2>Dokumentation der Funktionen</h2>
<a class="anchor" id="a5c4e337465e1bc9246137477d5b8e30c"></a><!-- doxytag: member="log.c::log_begin" ref="a5c4e337465e1bc9246137477d5b8e30c" args="(const char *filename, unsigned int line, LOG_TYPE log_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void log_begin </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LOG_TYPE&#160;</td>
          <td class="paramname"><em>log_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Schreibt Angaben ueber Datei, Zeilennummer und den Log-Typ in den Puffer. Achtung, Mutex wird gelockt und muss explizit durch <a class="el" href="log_8c.html#ab2c6faf6d03a5e0e458b683f1dc311fb">log_end()</a> wieder freigegeben werden! </p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Dateiname </td></tr>
    <tr><td class="paramname">line</td><td>Zeilennummer </td></tr>
    <tr><td class="paramname">log_type</td><td>Log-Typ </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00152">152</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Benutzt <a class="el" href="log_8c_source.html#l00099">LOCK</a> und <a class="el" href="log_8c_source.html#l00093">LOG_BUFFER_SIZE</a>.</p>

</div>
</div>
<a class="anchor" id="ab2c6faf6d03a5e0e458b683f1dc311fb"></a><!-- doxytag: member="log.c::log_end" ref="ab2c6faf6d03a5e0e458b683f1dc311fb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void log_end </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gibt den Puffer entsprechend aus. </p>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00308">308</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Benutzt <a class="el" href="uart_8c_source.html#l00119">uart_write()</a>, <a class="el" href="global_8h_source.html#l00097">LINE_FEED</a>, <a class="el" href="command_8c_source.html#l00332">command_write_data()</a>, <a class="el" href="command_8h_source.html#l00086">CMD_LOG</a>, <a class="el" href="command_8h_source.html#l00050">SUB_CMD_NORM</a>, <a class="el" href="mmc-vm_8c_source.html#l00375">mmc_flush_cache()</a>, <a class="el" href="mmc-vm_8c_source.html#l00347">mmc_get_data()</a> und <a class="el" href="log_8c_source.html#l00101">UNLOCK</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="log_8c_ab2c6faf6d03a5e0e458b683f1dc311fb_cgraph.png" border="0" usemap="#log_8c_ab2c6faf6d03a5e0e458b683f1dc311fb_cgraph" alt=""/></div>
<map name="log_8c_ab2c6faf6d03a5e0e458b683f1dc311fb_cgraph" id="log_8c_ab2c6faf6d03a5e0e458b683f1dc311fb_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4fff2f266fd439fbb104ddb5d7f61533"></a><!-- doxytag: member="log.c::log_printf" ref="a4fff2f266fd439fbb104ddb5d7f61533" args="(const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void log_printf </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Schreibt die eigentliche Ausgabeinformation in den Puffer. </p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">format</td><td>Format </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="log_8c_source.html#l00275">275</a> der Datei <a class="el" href="log_8c_source.html">log.c</a>.</p>

<p>Benutzt <a class="el" href="log_8c_source.html#l00093">LOG_BUFFER_SIZE</a>.</p>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Erzeugt am Don Aug 18 2011 12:13:05 für c't-Bot von &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5
</small></address>

</body>
</html>
